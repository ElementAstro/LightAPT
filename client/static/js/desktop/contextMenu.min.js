window.ContextMenu={_className:"yuri2-context-menu",_stopProp:function(e){e.cancelable&&(e.defaultPrevented||e.preventDefault()),e.stopImmediatePropagation(),e.stopPropagation()},_getMainContent:function(text){return text.replace(/<\/?.+?>/g,"")},render:function(e,menu,trigger,theme){theme||(theme="");var x=e.clientX,y=e.clientY;if(this._stopProp(e),this._removeContextMenu(),!0!==menu){"object"==typeof menu&&0===menu.length&&(menu=[["..."]]);var dom=$("<div class='"+ContextMenu._className+" "+theme+"'><ul></ul></div>");$("body").append(dom);var ul=dom.find("ul");x+150>document.body.clientWidth&&(x-=150,ul.addClass("left")),menu.forEach((function(item){if("|"===item)ul.append($("<hr/>"));else if("string"==typeof item)ul.append($('<li><div class="title" title="'+ContextMenu._getMainContent(item)+'">'+item+"</div></li>"));else if("object"==typeof item){var sub=$('<li><div class="title '+(!0===item[2]?"disable":"")+'" title="'+ContextMenu._getMainContent(item[0])+'">'+item[0]+"</div></li>");if(ul.append(sub),"object"==typeof item[1]){var subMenu=$("<div class='sub "+ContextMenu._className+" "+theme+"'></div>"),subUl=$("<ul></ul>");sub.addClass("sub"),subMenu.append(subUl),x+300>document.body.clientWidth&&subMenu.addClass("left"),sub.append(subMenu);var counterForTop=-1;item[1].forEach((function(t){if("|"===t)subUl.append($("<hr/>"));else if("string"==typeof t)subUl.append($('<li><div class="title" title="'+ContextMenu._getMainContent(t)+'">'+t+"</div></li>")),counterForTop++;else if("object"==typeof t){var subLi=$('<li><div class="title '+(!0===t[2]?"disable":"")+'" title="'+ContextMenu._getMainContent(t[0])+'">'+t[0]+"</div></li>");subUl.append(subLi),!0!==t[2]&&(subLi.click(trigger,t[1]),subLi.click((function(){ContextMenu._removeContextMenu()}))),counterForTop++}})),y+dom.height()>document.body.clientHeight&&document.body.clientHeight>0&&subMenu.css("top","-"+30*counterForTop+"px")}else"function"==typeof item[1]&&!0!==item[2]&&(sub.click(trigger,item[1]),sub.click((function(){ContextMenu._removeContextMenu()})))}})),y+dom.height()>document.body.clientHeight&&document.body.clientHeight>0&&(y-=dom.height()),dom.css({top:y,left:x})}},_removeContextMenu:function(){$("."+ContextMenu._className).remove()}},$(document).click((function(e){$(e.target).hasClass(ContextMenu._className)||$(e.target).parents("."+ContextMenu._className).length>0||ContextMenu._removeContextMenu()}));